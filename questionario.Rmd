---
title: "Análise questionário"
output: html_document
---

```{r, echo = FALSE, comment=FALSE, message=FALSE, fig.align='center'}

library(readr)

quest <- read_csv("C:/Users/Sueli/Desktop/Question+írioEstat+¡sticaB+ísica2.csv")

quest <- data.frame(quest[,-1], stringsAsFactors = FALSE)

names(quest) <- c("grau", "inic_p", "setor", "conc_grad", "loc_grad", "prog_grad", "inic_m","con_mest", "loc_mest", "art", "bols", "estat_grad", "estat_p", "soft", "met", "import", "trab", "sexo", "irm", "origem", "mora", "transp", "hab", "height", "weight", "pet", "instr", "nasc", "rede")

quest$grau <- tolower(iconv(quest$grau, to ='ASCII//TRANSLIT', from = "UTF-8"))

quest$inic_p <- as.integer(quest$inic_p)
quest$conc_grad <- as.integer(quest$conc_grad)
quest$inic_m <- as.integer(quest$inic_m)
quest$con_mest <- as.integer(quest$con_mest)
quest$art <- as.integer(quest$art)
quest$import <- as.integer(quest$import)
quest$irm <- as.integer(quest$irm)
quest$height <- as.numeric(quest$height)
quest$weight <- as.numeric(quest$weight)

for(i in 1:dim(quest)[1]){
  if(!quest$grau[i] == "doutorado" & !quest$grau[i] == "mestrado"){
    quest$grau[i] <- "outro"
  }
}

inic_p <- data.frame(ano = sort(unique(quest$inic_p[which(quest$inic_p >= 1994)])), n = numeric(length(unique(quest$inic_p[which(quest$inic_p >= 1994)]))))
for(i in 1:dim(inic_p)[1]){inic_p$n[i] <- sum(quest$inic_p == inic_p$ano[i])}

conc_grad <- data.frame(ano = sort(unique(quest$conc_grad[which(quest$conc_grad >= 1950)])), n = numeric(length(unique(quest$conc_grad[which(quest$conc_grad >= 1950)]))))
for(i in 1:dim(conc_grad)[1]){conc_grad$n[i] <- sum(quest$conc_grad == conc_grad$ano[i])}
conc_grad <- conc_grad[which(conc_grad$ano < 2030),]

quest$loc_grad <- tolower(iconv(quest$loc_grad, to ='ASCII//TRANSLIT', from = "UTF-8"))

quest$loc_grad[which(!quest$loc_grad == "ufpr")] <- "outro"

quest$loc_mest <- tolower(iconv(quest$loc_mest, to ='ASCII//TRANSLIT', from = "UTF-8"))

quest$loc_mest[which(!quest$loc_mest == "ufpr")] <- "outro"

quest$bols <- tolower(iconv(quest$bols, to ='ASCII//TRANSLIT', from = "UTF-8"))

library(splitstackshape, quietly = TRUE)

quest$soft <- tolower(iconv(quest$soft, to = 'ASCII//TRANSLIT', from = "UTF-8"))
quest$soft <- gsub(" e ", ";", quest$soft)
quest$soft <- gsub("\\.", "", quest$soft)
quest$soft <- gsub("[0-9]", "", quest$soft)
quest$soft <- gsub("sim\\.* *", "", quest$soft)
quest$soft <- gsub(",", ";", quest$soft)
quest$soft <- gsub("ibm ", "", quest$soft)

software <- as.character(cSplit(quest, "soft", sep = ";", direction = "long")$soft)

software[which(software == "r studio" | software == "rstudio")] <- "r"
software[which(substr(software, 1, 2) == "r ")] <- "r"
software[which(software == "o r")] <- "r"
software[which(substr(software, 1, 3) == "nao" | substr(software, 1, 5) == "nunca")] <- "nao"
software <- gsub("software ", "", software)
software <- gsub("\\s+[[:print:]]*", "", software)
software <- software[which(!software == "")]

quest$transp <- tolower(iconv(quest$transp, to ='ASCII//TRANSLIT', from = "UTF-8"))

quest$instr <- tolower(iconv(quest$instr, to ='ASCII//TRANSLIT', from = "UTF-8"))
instr <- cSplit(quest, "instr", sep = ";", direction = "long")$instr

prog <- cSplit(quest, "prog_grad", sep = ";", direction = "long")$prog_grad

social <- cSplit(quest, "rede", sep = ";", direction = "long")$rede

library(lattice)
library(plotrix)
library(scales)

pie3D(table(quest$grau), col = c("red", "blue"), 
      labels = percent(as.vector(prop.table(table(quest$grau)))), height = .07, start = 3*pi/4)
title("Proporção de Mestrandos x Doutorandos")
legend(-.8, 1, legend = c("Doutorado", "Mestrado"), fill = c("red", "blue"))

par(mfrow = c(1,2))

mest <- quest[which(quest$grau == "mestrado"), c(2, 4)]
dout <- quest[which(quest$grau == "doutorado"), c(2, 4, 7, 8)]


```

<html>
<body>
<center>
<font size="4">**Dispersão de ingressão**</font>
</center>
</body>
</html>

```{r, echo = FALSE, comment=FALSE, message=FALSE, fig.align='center'}
par(mfrow = c(1, 2))
plot(mest$inic_p, mest$conc_grad, col = "blue", type = "p",
     xlim = c(min(min(mest$inic_p), min(dout$inic_m)) - 2, max(max(mest$inic_p), max(dout$inic_m))) + 2,
     ylim = c(min(min(mest$conc_grad), min(dout$conc_grad)) - 2, max(max(mest$conc_grad), max(dout$conc_grad))) + 2,
     xlab = "Ano de ingresso no Mestrado", ylab = "Ano de conclusão da Graduação", pch = 16)
points(dout$inic_m, dout$conc_grad, col = "red", pch = 19)
legend("topleft", legend = c("Mestrado", "Doutorado"), pch = c(16, 19), col = c("blue", "red"))
plot(dout$inic_p, dout$con_mest, col = "darkgreen", type = "p", xlab = "Ano de ingresso no Doutorado", 
     ylab = "Ano de ingresso no Mestrado", pch = 16, ylim = c(2000, 2018))

#x11()

par(mfrow = c(1,1))

barplot(table(quest$setor), col = rainbow(length(unique(quest$setor))), names.arg = FALSE, xlim = c(0, 10),
        ylim = c(0, max(table(quest$setor) + 10)), main = "Setores")
legend("topright", legend = sort(unique(quest$setor)), fill = rainbow(length(unique(quest$setor))), bty = "n")

#Região dedicada pra plotar o mapa
#
#
#
#
####


x11()
pie3D(table(prog), col = c("darkgreen", "red", "blue"), explode = .1, 
      labels = percent(as.vector(prop.table(table(prog)))), height = .07, start = 3*pi/4, main = "Bolsa graduação")
legend(-.8, 1, legend = sort(unique(prog)), fill = c("darkgreen", "red", "blue"), bty = "n")

boxplot(quest$art, main = "Boxplot de artigos publicados", horizontal = TRUE)
hist(quest$art, main = "Histograma de artigos publicados", col = "azure4", xlab = "Artigos publicados",
     ylab = "Frequência")

x11()
pie3D(table(quest$bols), col = heat.colors(length(unique(quest$bols))), explode = .1, main = "Bolsa Pós Graduação",
      labels = percent(as.vector(prop.table(table(quest$bols)))), height = .07, start = 3*pi/4)
legend(-.8, 1, legend = sort(unique(quest$bols)), fill = heat.colors(length(unique(quest$bols))), bty = "n")

par(mfrow = c(1, 2))

pie3D(table(quest$estat_grad), col = c("red", "blue"), main = "Cursou Estatística\nna Graduação?",
      labels = percent(as.vector(prop.table(table(quest$estat_grad)))), height = .07, start = 3*pi/4)
legend(-.8, 1, legend = c("Não", "Sim"), fill = c("red", "blue"))

pie3D(table(quest$estat_p), col = c("darkgreen", "brown"), main = "Cursou Estatística\nna Pós Graduação?",
      labels = percent(as.vector(prop.table(table(quest$estat_p)))), height = .07, start = 3*pi/4)
legend(-.8, 1, legend = c("Não", "Sim"), fill = c("darkgreen", "brown"))

par(mfrow = c(1,1))

barplot(table(software), col = topo.colors(length(unique(software))), main = "Softwares Estatísticos")

pie3D(table(quest$met), col = c("red", "blue", "green"), main = "Vai utilizar métodos\nestatísticos?",
      labels = percent(as.vector(prop.table(table(quest$met)))), height = .07, start = 3*pi/4)
legend(-.8, 1, legend = c("Não", "Não sabe","Sim"), fill = c("red", "blue", "green"), bty = "n")

barplot(table(quest$import), col = heat.colors(length(unique(quest$import))), main = "Importância da estatística\nno trabalho de PG")

pie3D(table(quest$trab), col = c("red", "blue"), main = "Trabalha?",
      labels = percent(as.vector(prop.table(table(quest$trab)))), height = .07, start = 3*pi/4)
legend(-.8, 1, legend = c("Não", "Sim"), fill = c("red", "blue"), bty = "n")

pie3D(table(quest$sexo), col = c("red", "blue"), main = "Sexo",
      labels = percent(as.vector(prop.table(table(quest$sexo)))), height = .07, start = 3*pi/4)
legend(-.8, 1, legend = c("Feminino", "Masculino"), fill = c("red", "blue"), bty = "n")

barplot(table(quest$irm), col = rainbow(length(unique(quest$irm))), main = "Número de irmãos")

pie3D(table(quest$origem), col = c("red", "blue", "green"), main = "Origem",
      labels = percent(as.vector(prop.table(table(quest$origem)))), height = .07, start = 3*pi/4)
legend(-.8, 1, legend = c("Curitiba & Região", "Interior PR", "Outro estado"), fill = c("red", "blue", "green"),
       bty = "n")

barplot(table(quest$mora), col = rainbow(length(unique(quest$mora))), main = "Você mora")

pie3D(table(quest$transp), col = terrain.colors(length(unique(quest$transp))), main = "Meio de transporte principal",
      labels = percent(as.vector(prop.table(table(quest$transp)))), height = .07, start = 3*pi/4)
legend(-.9, 1, legend = sort(unique(quest$transp)), fill = terrain.colors(length(unique(quest$transp))), bty = "n")

pie3D(table(quest$hab), col = terrain.colors(length(unique(quest$hab))), main = "Possui habilitação? Qual?",
      labels = percent(as.vector(prop.table(table(quest$hab)))), height = .07, start = 3*pi/4)
legend(-.9, 1, legend = sort(unique(quest$hab)), fill = terrain.colors(length(unique(quest$hab))), bty = "n")

par(mfrow = c(1,2))

boxplot(quest$height, col = "red", main = "Altura")
boxplot(quest$weight, col = "blue", main = "Peso")

par(mfrow = c(1,1))

pie3D(table(quest$pet), col = c("red", "blue"), main = "Possui animal de estimação?",
      labels = percent(as.vector(prop.table(table(quest$pet)))), height = .07, start = 3*pi/4)
legend(-.8, 1, legend = c("Não", "Sim"), fill = c("red", "blue"), bty = "n")

barplot(table(instr), col = rainbow(length(unique(instr))), main = "Toca algum instrumento musical?")

barplot(table(social), col = topo.colors(length(unique(social))), main = "De quais redes sociais participa?")

```

